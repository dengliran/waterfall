/*!
 * waterfall v1.0.0 (https://github.com/dengliran/waterfall#readme)
 * Developed by dengliran in June 2017
 */
!function(t,i){var n={itemsClass:".waterfall-item",itemsAnimate:!0,fallEndCallback:function(){}};i.fn.waterfall=function(e){function s(t,i){return"max"==t?Math.max.apply(Math,i):"min"==t?Math.min.apply(Math,i):void 0}function o(t,i){for(var n=0;n<i.length;n++)if(i[n]===t)return n}var a,r,h,l=i.extend({},n,e),u=this,c=u.find(l.itemsClass),f=[],m=0,d=100,_=i.fn.waterfall;_._initDomStyle=function(){return u.css({position:"relative",margin:"0 auto"}),c.css({position:"absolute"}),l.itemsAnimate&&c.css({"transition-property":"top,left","transition-duration":"400ms","transition-timing-function":"ease-out"}),a=parseInt(c.css("width")),this},_._setContainerWidth=function(){return u.width("auto"),r=u.width(),h=Math.floor(r/a),u.width(h*a),this},_._imgLoadIng=function(){return c.each(function(t,n){var e=i(this).find("img"),s=new Image;if(s.src=e.attr("src"),s.complete)return void m++;e.on("load",function(){m++})}),this},_._checkImgloadstatus=function(){var t=arguments;return _._setItemPosition(),m<c.length&&d<3e3?setTimeout(function(){d+=100,t.callee()},d):m===c.length?_._setItemPosition():(_._setItemPosition(),console.error("waterfall_ERR: "+(c.length-m)+"_TIMED_OUT")),this},_._setItemPosition=function(){return f=[],c.each(function(t,n){if(t<h)f.push(parseInt(i(this).css("height"))),i(this).css({top:0,left:t*a,position:"absolute"});else{var e=s("min",f),r=o(e,f);i(this).css({top:e,left:a*r,position:"absolute"}),f[r]+=parseInt(i(this).css("height"))}}),this._setContainerHeight(),l.fallEndCallback(),this},_._setContainerHeight=function(){var t=s("max",f);return u.height(t),this},_._bindEvent=function(){var n=!0;return i(t).on("resize",function(){n&&(_._setContainerWidth()._setItemPosition(),n=!1,setTimeout(function(){n=!0},600))}),this},i(this).length&&function(){_._initDomStyle()._setContainerWidth()._imgLoadIng()._checkImgloadstatus()._bindEvent()}()}}(window,window.jQuery);